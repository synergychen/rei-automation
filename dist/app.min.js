(()=>{var e={588:(e,t,s)=>{const r=s(65),a=s(203),n=function e(t){if("function"!=typeof r.readdirSync)return[];const s=r.readdirSync(t,{withFileTypes:!0}),n=s.filter((e=>e.isFile()&&".js"===a.extname(e.name))).map((e=>a.join(t,e.name))),i=s.filter((e=>e.isDirectory()));for(const s of i){const r=e(a.join(t,s.name));n.push(...r)}return n}("./src");var i,o,c;i="src/app.js",o="paths",c=n,r.readFile(i,"utf8",((e,t)=>{if(e)throw e;const s=new RegExp(o+"\\s*=\\s*\\[([\\s\\S]*?)\\]","g").exec(t);if(!s)throw new Error(`Variable ${o} not found`);t=t.replace(s[0],`${o} = ${JSON.stringify(c,null,2)}`),r.writeFile(i,t,"utf8",(e=>{if(e)throw e;console.log(`Variable ${o} replaced successfully`)}))}))},672:(e,t,s)=>{["src/app.js","src/db/data_api.js","src/models/deal.js","src/models/message.js","src/models/property.js","src/models/rent.js","src/services/bigger_pockets_rent_api.js","src/services/home_details_api.js","src/services/zillow.js","src/utils/constants.js","src/utils/helpers.js","src/utils/renderer.js","src/utils/session.js","src/utils/analyzers/deal_analyzer.js","src/utils/analyzers/property_analyzer.js","src/utils/annotators/home_details_annotator.js","src/utils/annotators/map_annotator.js","src/utils/automator/bigger_pockets_rent_automator.js","src/utils/automator/email_automator.js","src/utils/automator/rentometer_automator.js","src/utils/parsers/home_details_parser.js","src/utils/parsers/rent_parser.js"].forEach((t=>{const r=s(454)("./"+t);Object.assign(e.exports,r)}))},807:(e,t,s)=>{const{serializeAddress:r}=s(325),{STATUS:a}=s(559),{Property:n}=s(643),{Message:i}=s(636);class o{static BASE_URL="https://us-central1-rei-automation.cloudfunctions.net/api";static SECURITY_TOKEN;static instance;constructor(){if(o.instance)return o.instance;o.instance=this}static setSecurityToken(e){o.SECURITY_TOKEN=e}get securityToken(){return o.SECURITY_TOKEN}async properties(){return(await this.getRequest("/properties")).map((e=>new n(e)))}async propertiesWithoutBiggerPocketsRent(){return(await this.getRequest(`/properties?status=${a.default}`)).map((e=>new n(e))).filter((e=>!e.rents.find((e=>e.hasBiggerPockets))))}async propertiesWithoutRentometerRent(){return(await this.getRequest(`/properties?status=${a.default}`)).map((e=>new n(e))).filter((e=>!e.rents.find((e=>e.hasRentometer))))}async hasProperty(e){return!!await this.findProperty(e)}async findProperty(e){e=r(e);const t=await this.getRequest(`/properties/${e}`);return t&&new n(t)}async addProperty(e){return e.address=r(e.address),await this.postRequest("/properties",e)}async updateProperty(e){return e.address=r(e.address),await this.updateRequest(`/properties/${e.address}`,e)}async removeProperty(e){return e=r(e),await this.deleteRequest(`/properties/${e}`)}async updateRent(e){const t=await this.findProperty(e.address);if(t)return t.updateRent(e),await this.updateProperty(t)}async deals(){return await this.getRequest("/deals")}async isDeal(e){const t=await this.findProperty(e);return t&&t.isDeal}async setDeal(e){return await this.updatePropertyStatus(e,a.deal)}async setNotADeal(e){return await this.updatePropertyStatus(e,a.notADeal)}async interested(){return await this.getRequest("/interested")}async isInterestedIn(e){const t=await this.findProperty(e);return t&&t.isInterested}async setInterested(e){return await this.updatePropertyStatus(e,a.interested)}async setNotInterested(e){return await this.updatePropertyStatus(e,a.notInterested)}async emails(e=i.TO_DO){return(await this.getRequest(`/messages?status=${e}`)).map((e=>new i(e)))}async markEmailAsRead(e){const t=await this.getRequest(`/messages/${e}`);if(t)return t.status=i.DONE,await this.updateRequest(`/messages/${e}`,t)}async syncEmails(){const e=(await this.getRequest("http://localhost:3000/messages?label=rei-agent",!0)).map((e=>new i(e)));return await this.postRequest("/messages",e)}async updatePropertyStatus(e,t){const s=await this.findProperty(e);if(s)return s.status=t,await this.updateProperty(s)}getRequest(e,t=!1){return e=t?e:o.BASE_URL+e,fetch(e,{headers:{Authorization:"Bearer "+o.SECURITY_TOKEN}}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).catch((e=>{console.error("There was an error!",e)}))}postRequest(e,t){return fetch(o.BASE_URL+e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+o.SECURITY_TOKEN},body:JSON.stringify(t)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return"OK"})).catch((e=>{console.error("There was an error!",e)}))}updateRequest(e,t){return fetch(o.BASE_URL+e,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+o.SECURITY_TOKEN},body:JSON.stringify(t)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return"OK"})).catch((e=>{console.error("There was an error!",e)}))}deleteRequest(e){return fetch(o.BASE_URL+e,{method:"DELETE",headers:{Authorization:"Bearer "+o.SECURITY_TOKEN}}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return"OK"})).catch((e=>{console.error("There was an error!",e)}))}}e.exports={DataAPI:o}},537:(e,t,s)=>{const{Rent:r}=s(326);class a{static RENT_TO_PRICE_PERCENT_THRESHOLD=.7;constructor({property:e,rents:t=[],percentThreshold:s=a.RENT_TO_PRICE_PERCENT_THRESHOLD}){this.property=e,this.rents=t.map((e=>new r(e))),this.percentThreshold=s}isReady(){return this.property.valid&&this.rents.length>1}isGood(){for(const e of this.rents)if(this._isGood(e,this.property))return!0;return!1}_isGood(e,t){if(!(this._rentToPrice(e,t)<0))return this._rentToPrice(e,t)>=this.percentThreshold/100}_rentToPrice(e,t){return e.median<=0||t.price<=0?-1:e.median/t.price}}e.exports={Deal:a}},636:e=>{class t{static TO_DO="TO_DO";static DONE="DONE";constructor({id:e,subject:s,from:r,addresses:a,date:n,status:i=t.TO_DO}){this.id=e,this.subject=s,this.from=r,this.addresses=a,this.date=n,this.status=i}}e.exports={Message:t}},643:(e,t,s)=>{const{PROPERTY_ATTRIBTUES:r,STATUS:a}=s(559),{Rent:n}=s(326);class i{static TWO_BEDS_MEDIAN_SIZE=1300;static THREE_BEDS_MEDIAN_SIZE=1600;static FOUR_BEDS_MEDIAN_SIZE=1900;constructor(e={}){for(const t of r)this[t]=e[t]??null;this.rents||=[],this.rents=this.rents.map((e=>new n(e))),this.schoolScores||=[],this.priceHistory||=[],this.status||=a.default,this.update()}get valid(){return this.address&&this.address.length>5&&this.bedrooms>0&&this.price>0&&this.sqft>0}get isLargeSize(){switch(this.bedrooms){case 2:if(this.sqft>=i.THREE_BEDS_MEDIAN_SIZE)return!0;break;case 3:if(this.sqft>=i.FOUR_BEDS_MEDIAN_SIZE)return!0;break;case 4:if(this.sqft>=i.FOUR_BEDS_MEDIAN_SIZE+300)return!0}return!1}get isSmallSize(){switch(this.bedrooms){case 2:if(this.sqft<i.TWO_BEDS_MEDIAN_SIZE-300)return!0;break;case 3:if(this.sqft<i.TWO_BEDS_MEDIAN_SIZE)return!0;break;case 4:if(this.sqft<i.THREE_BEDS_MEDIAN_SIZE)return!0}return!1}get hasGoodSchool(){return this.schoolScores.some((e=>e>=7))}get goodSchoolsCount(){return this.schoolScores.filter((e=>e>=7)).length}get allBadSchools(){return this.schoolScores.every((e=>e<=4))}get priceIncreases(){return this.priceHistory.filter((e=>e.percentChange>0))}get priceDecreases(){return this.priceHistory.filter((e=>e.percentChange<0))}get totalPriceIncrease(){return this.priceIncreases.reduce(((e,{percentChange:t})=>e+t),0)}get totalPriceDecrease(){const e=this.priceDecreases.reduce(((e,{percentChange:t})=>e+t),0);return parseFloat(e.toFixed(2))}get toBeAnalyzed(){return this.status===a.default}get isAnalyzed(){return this.status!==a.default}get isDeal(){return this.status===a.deal}get isInterested(){return this.status===a.isInterested}setDeal(){this.status=a.deal}setNotADeal(){this.status=a.notADeal}setInterested(){this.status=a.interested}setNotInterested(){this.status=a.notInterested}setOffer(){this.status=a.offer}getDeal(e=.7){return new Deal({property:this,rents:this.rents,percentThreshold:e})}update(){const{city:e,state:t,zipcode:s}=this.parseAddress();this.city=e,this.state=t,this.zipcode=this.zipcode||s;const r=this.getDeal();this.valid&&this.toBeAnalyzed&&r.isReady()&&(r.isGood()?this.setDeal():this.setNotADeal()),this.updatedAt=(new Date).toISOString().replace(/T/," ").replace(/\..+/,"")}updateRent(e){e=new n(e);const t=this.rents.findIndex((t=>t.source===e.source));-1!==t?this.rents[t]=e:this.rents.push(e),this.update()}parseAddress(){if(!this.address)return{};try{const e=this.address.split(",").map((e=>e.trim())),t=e&&e[1],s=e[2].match(/\d{5}$/),r=s&&s[0],a=e[2].match(/\w{2}/);return{city:t,state:a&&a[0],zipcode:r}}catch(e){return console.log(e),{}}}}e.exports={Property:i}},326:e=>{class t{static RENTOMETER="Rentometer";static BIGGER_POCKETS="BiggerPockets";static ZILLOW="Zestimate";constructor({address:e=null,zipcode:t=null,average:s=null,median:r=null,pct25th:a=null,pct75th:n=null,count:i=null,source:o=null}={}){this.address=e,this.zipcode=t,this.average=s,this.median=r,this.pct25th=a,this.pct75th=n,this.count=i,this.source=o}get key(){return this.zipcode&&!this.address?`${this.zipcode}|${this.source}`:!this.zipcode&&this.address?`${this.address}|${this.source}`:void 0}get hasBiggerPockets(){return this.source===t.BIGGER_POCKETS}get hasRentometer(){return this.source===t.RENTOMETER}setRentometer(){this.source=t.RENTOMETER}setBiggerPockets(){this.source=t.BIGGER_POCKETS}setZillow(){this.source=t.ZILLOW}}e.exports={Rent:t}},854:(e,t,s)=>{const{BiggerPocketsRentParser:r}=s(849);class a{static async fetchAll(e){const t={};for(const s of e){const e=await a.fetch(s);e&&(t[e.address]=e)}return t}static async fetch(e,t){const s=`https://www.biggerpockets.com/insights/locations?validated_address_search[address]=${encodeURIComponent(e)}&validated_address_search[structure_type]=house&validated_address_search[beds]=${t}&adjust_details=true&commit=Adjust details`,a=await fetch(s,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"});try{const e=await a.text(),t=(new DOMParser).parseFromString(e,"text/html");return r.parse(t)}catch(e){return console.log(e),null}}}e.exports={BiggerPocketsRentAPI:a}},259:(e,t,s)=>{const{Property:r}=s(643);class a{static async fetchAll(e){const t={};for(const s of e){const e=await a.fetch(s);e&&(t[e.address]=e)}return t}static async fetch(e){const t=`https://www.zillow.com/homes/${encodeURIComponent(e)}`,s=await fetch(t,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7","sec-ch-ua":'"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET"});try{const e=await s.text(),t=(new DOMParser).parseFromString(e,"text/html"),r=JSON.parse(t.body.querySelector("#__NEXT_DATA__").innerText).props.pageProps,n=JSON.parse(r.gdpClientCache||r.initialData.building),i=n[Object.keys(n)[0]].property;return a.parse(i)}catch(e){return console.log(e),null}}static parse(e){const{address:t,price:s,bedrooms:n,bathrooms:i,homeType:o,homeStatus:c,yearBuilt:d,livingArea:l,daysOnZillow:h,propertyTaxRate:p,schools:u,priceHistory:m,comps:g,nearbyHomes:y}=e,{streetAddress:f,city:w,state:_,zipcode:S}=t;return new r({address:`${f}, ${w}, ${_} ${S}`,streetAddress:f,city:w,state:_,zipcode:S,homeType:o,homeStatus:c,price:s,bedrooms:n,bathrooms:i,yearBuilt:d,sqft:l,daysOnMarket:h,propertyTaxes:parseInt(p*s/100),schools:u,schoolScores:(u||[]).map((e=>e.rating)),priceHistory:(m||[]).map((e=>({date:e.date,priceChange:e.priceChangeRate,price:e.price,event:e.event,time:e.time}))),rents:[],comps:(g||[]).map((e=>a.parse(e))),nearbyHomes:(y||[]).map((e=>a.parse(e)))})}}e.exports={HomeDetailsAPI:a}},712:e=>{e.exports={Zillow:class{constructor(e=null){this.rawData=e,this.dataMapping={zpid:"hdpData.homeInfo.zpid",type:"statusType",address:this._fetchAddress,zipcode:"hdpData.homeInfo.zipcode",city:"hdpData.homeInfo.city",state:"hdpData.homeInfo.state",url:this._fetchUrl,price:"hdpData.homeInfo.price",bedrooms:"hdpData.homeInfo.bedrooms",bathrooms:"hdpData.homeInfo.bathrooms",homeSize:"hdpData.homeInfo.livingArea",lotSize:this._fetchLotSize,homeType:"hdpData.homeInfo.homeType",yearBuilt:"",latitude:"hdpData.homeInfo.latitude",longitude:"hdpData.homeInfo.longitude",taxAssessedValue:"hdpData.homeInfo.taxAssessedValue",zestimate:"hdpData.homeInfo.zestimate",rentZestimate:"hdpData.homeInfo.rentZestimate",updatedAt:this._fetchUpdatedAt}}fetch(e){const t=this.jsonDataUrlFor(e);return fetch(t).then((e=>e.json())).then((e=>(this.rawData=e,e)))}summaryCsvData(){const{address:e,bedrooms:t,average:s,median:r,average_size:a,median_size:n,data_points:i}=this.summary();return[[e,t,s,r,a,n,i]]}summary(){const e=this.mappedData();return{address:e.find((e=>e.zipcode.match(/^\d{5}$/)))&&e.find((e=>e.zipcode.match(/^\d{5}$/))).zipcode,bedrooms:e.find((e=>e.bedrooms>0))&&e.find((e=>e.bedrooms>0)).bedrooms,average:this.averagePrice(e),median:this.medianPrice(e),"25th":this.median25thPrice(e),"75th":this.median75thPrice(e),average_size:this.averageSize(e),median_size:this.medianSize(e),data_points:this.dataPoints(e)}}query(){if(!this.rawData)return"";const e=(this.rawData.searchPageSeoObject&&this.rawData.searchPageSeoObject.windowTitle).match(/^(.+) Real Estate/);return e&&e[1]}csvData(){return this.mappedData().map((e=>Object.values(e)))}jsonDataUrlFor(e){return`https://www.zillow.com/search/GetSearchPageState.htm?${e.match(/(.+)\?(.+)/)[2]}&wants={%22cat1%22:[%22listResults%22,%22mapResults%22]}&requestId=3`}averagePrice(e){const t=e.map((e=>parseInt(e.price))).filter((e=>e>0));return this._average(t)}medianPrice(e){const t=e.map((e=>parseInt(e.price))).filter((e=>e>0));return this._median(t)}median25thPrice(e){const t=e.map((e=>parseInt(e.price))).filter((e=>e>0));return this._median25th(t)}median75thPrice(e){const t=e.map((e=>parseInt(e.price))).filter((e=>e>0));return this._median75th(t)}averageSize(e){const t=e.map((e=>parseInt(e.homeSize))).filter((e=>e>0));return this._average(t)}medianSize(e){const t=e.map((e=>parseInt(e.homeSize))).filter((e=>e>0));return this._median(t)}dataPoints(e){return e.map((e=>parseInt(e.price))).filter((e=>e>0)).length}_average(e){if(0===e.length)return-1;const t=e.reduce(((e,t)=>e+t))/e.length;return 1e3*Math.round(t/1e3)}_median(e){if(0==e.length)return-1;e.sort(((e,t)=>e-t));const t=Math.floor(e.length/2);return e.length%2==1?e[t]:(e[t-1]+e[t])/2}_median25th(e){return 0==e.length?-1:(e.sort(((e,t)=>e-t)),e[Math.ceil(.25*e.length)-1])}_median75th(e){return 0==e.length?-1:(e.sort(((e,t)=>e-t)),e[Math.ceil(.75*e.length)-1])}mappedData(){const e=this._getMapResults();return this._getMappedMapResults(e)}_getMapResults(){return this._getDataByPath(this.rawData,"cat1.searchResults.mapResults")}_getMappedMapResults(e){const t=[];for(let s=0;s<e.length;s++){let r={};Object.keys(this.dataMapping).forEach((t=>{const a=this.dataMapping[t];r[t]=this._getDataByPath(e[s],a)})),t.push(r)}return t}_getDataByPath(e,t){switch(typeof t){case"string":const s=t.split(".");if(0===s.length)return"-";for(let t=0;t<s.length;t++){if(!e)return"-";e=e[s[t]]}return e;case"function":return t.bind(this)(e);default:return t}}_fetchAddress(e){return e.detailUrl.split("/")[2].replaceAll("-"," ")}_fetchUrl(e){return e.detailUrl?"https://www.zillow.com"+e.detailUrl:""}_fetchLotSize(e){const t=this._getDataByPath(e,"hdpData.homeInfo.lotAreaValue"),s=this._getDataByPath(e,"hdpData.homeInfo.lotAreaUnit");return"sqft"===s?t:"acres"===s?Math.floor(43560*t):"-"}_fetchUpdatedAt(e){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}}}},988:(e,t,s)=>{const{DataAPI:r}=s(807),{Deal:a}=s(537);e.exports={DealAnalyzer:class{static async goodDeals(e=.7){const t=new r,s=await t.properties();return(await Promise.all(s.map((async t=>{const s=t.rents;return new a({property:t,rents:s,percentThreshold:e}).isGood()?t:null})))).filter((e=>null!==e))}}}},487:(e,t,s)=>{const{DataAPI:r}=s(807);e.exports={PropertyAnalyzer:class{static async analyze(){const e=new r,t=await currentProperty();t.valid&&(await e.addProperty(t),console.log("Property saved"));const s=new URLSearchParams(window.location.search).get("delay"),a=`address=${t.address}&bedrooms=${t.bedrooms}&delay=${s}`;[`https://www.biggerpockets.com/insights/locations?validated_address_search%5Baddress%5D=${t.address}+++&validated_address_search%5Bstructure_type%5D=&validated_address_search%5Bbeds%5D=${t.bedrooms}&validated_address_search%5Bbaths%5D=${t.bathrooms}&adjust_details=true&commit=Adjust+details&${a}`,`https://www.rentometer.com/?${a}`].forEach((e=>window.open(e,"_blank")))}static async analyzeProperties(e){}static async analyzeRentometerRents(e){}static async analyzeBPRents(e){}}}},52:(e,t,s)=>{const{DataAPI:r}=s(807),{Renderer:a}=s(754),{COLORS:n,STATUS:i}=s(559),{rentToPrice:o,toPercent:c,findElementUntil:d}=s(325),{currentProperty:l}=s(230),{PropertyAnalyzer:h}=s(487);class p{constructor(){this.dataApi=new r,this.property=null}static async annotate(){const e=new p;e.property=await l(),e.property?await e.annotate():console.log("Current property not exists")}async annotate(){this.annotateAddress(),await this.renderHomeSummary(),this.renderSelects(),await this.renderLinks(),await this.renderChips()}renderSelects(){this.addContainer("selects-container"),this.property.isAnalyzed&&this.renderStatusSelect()}async renderLinks(){this.addContainer("links-container"),this.property.isAnalyzed||this.renderAnalyzeLink(),await this.renderRentometerLink(),await this.renderBPRentLink(),await this.renderLotLines()}async renderChips(){this.addContainer("chips-container"),await this.renderPriceChanges(),await this.renderDaysOnMarketChip(),await this.renderSizeChip(),await this.renderSchoolChip()}async renderHomeSummary(){const e=this.property.rents;if(this.property&&e.length>0){const t={Year:this.property.yearBuilt,"Days on Market":this.property.daysOnMarket};e.forEach((e=>{t["Rent / "+e.source]=e.median,t["Ratio / "+e.source]=c(o(e.median,this.property.price))})),a.render(t)}else console.log("No analysis done for this property")}renderStatusSelect(){const e=document.createElement("select");for(const t of Object.values(i)){const s=document.createElement("option");s.text=t,t===this.property.status&&(s.selected=!0,t===i.notADeal&&(e.disabled=!0)),e.appendChild(s)}e.addEventListener("change",(async e=>{this.property.status=e.target.value,await this.dataApi.updateProperty(this.property)}));const t=document.getElementById("selects-container");e.style.cssText="margin: 0 15px; border-radius: 5px; width: 150px; height: 35px;",t.appendChild(e)}renderAnalyzeLink(){const e=this.addLink("Analyze");e.href="#",e.onclick=async()=>(await h.analyze(),!1),e.textContent="Analyze"}async renderPriceChanges(){const e="price-change-chip";if(document.querySelector("."+e))return;const t=this.property;t.priceIncreases.length>0&&this.addChip(e,`Price Increase: ${t.totalPriceIncrease}% (${t.priceIncreases.length})`,n.lightRed,n.red),t.priceDecreases.length>0&&this.addChip(e,`Price Cut: ${t.totalPriceDecrease}% (${t.priceDecreases.length})`,n.lightGreen,n.green)}async renderDaysOnMarketChip(){const e="days-on-market-chip";if(document.querySelector("."+e))return;const t=this.property,s=t.daysOnMarket>0?30*Math.floor(t.daysOnMarket/30):-1;s>=60?this.addChip(e,`DOM: ${s}+`,n.lightGreen,n.green):s>=30?this.addChip(e,`DOM: ${s}+`,n.lightYellow,n.yellow):this.addChip(e,"DOM < 30",n.lightRed,n.red)}async renderSizeChip(){const e="size-chip";if(document.querySelector("."+e))return;const t=this.property;t.sqft<0||(t.isLargeSize?this.addChip(e,"Size: L",n.lightGreen,n.green):t.isSmallSize?this.addChip(e,"Size: S",n.lightRed,n.red):this.addChip(e,"Size: M",n.lightGray,n.gray))}async renderSchoolChip(){const e="school-chip";if(document.querySelector("."+e))return;const t=this.property;t.hasGoodSchool?this.addChip(e,`SCH: Good (${t.goodSchoolsCount})`,n.lightGreen,n.green):t.allBadSchools&&this.addChip(e,"SCH: Bad",n.lightRed,n.red)}async renderLotLines(){this.addLink("Lot Lines").addEventListener("click",(async()=>{const e=await d("a",/facts and features/i,3e3);e&&e.click();const t=await d('[data-zon="commute"] title',/expand this map/i,3e3);if(!t)return;t.parentElement.parentElement.click();const s=await d("section#map-lightbox button",/lot lines/i,3e3);s&&s.click()}))}async renderBPRentLink(){const e=`https://www.biggerpockets.com/insights/locations?validated_address_search%5Baddress%5D=${this.property.address}+++&validated_address_search%5Bstructure_type%5D=&validated_address_search%5Bbeds%5D=${this.property.bedrooms}&validated_address_search%5Bbaths%5D=${this.property.bathrooms}&adjust_details=true&commit=Adjust+details`;this.addLink("BP Rent",e)}async renderRentometerLink(){const e=`https://www.rentometer.com/?address=${this.property.address}&bedrooms=${this.property.bedrooms}`;this.addLink("Rentometer",e)}addLink(e,t=""){const s=e.replaceAll(" ","-").toLowerCase();if(document.querySelector("#"+s))return;const r=document.createElement("a");return t&&(r.href=t,r.target="_blank"),r.innerText=e,r.style.cssText="border: 1px solid; border-radius: 5px; padding: 6px 10px; margin-left: 15px;",document.querySelector("#links-container").append(r),r}addChip(e,t,s,r){const a=document.createElement("div");a.innerText=t,a.classList.add(e),a.style.cssText=`border: 1px solid ${r}; border-radius: 5px; padding: 3px 5px; margin-left: 15px; background-color: ${s};align-items: center; display: flex; height: 30px; margin-top: 10px;`,this.getChipsContainer().appendChild(a)}addContainer(e){if(document.querySelector("#"+e))return;const t=document.createElement("div");return t.setAttribute("id",e),t.style.cssText="display: flex; flex-wrap: wrap; margin-bottom: 10px;",document.querySelector(".summary-container").querySelector('[data-renderstrat="inline"]').insertAdjacentElement("afterend",t),t}getChipsContainer(){return document.querySelector("#chips-container")}getLinksContainer(){return document.querySelector("#links-container")}annotateAddress(){const e=document.querySelector(".summary-container h1"),t=e.innerText,s=document.createElement("a");s.href=`https://www.google.com/maps?q=${encodeURIComponent(t)}`,s.target="_blank",s.innerText=t,e.innerHTML="",e.appendChild(s)}getAddress(){return document.querySelector(".summary-container h1").innerText}getElementById(e){return[...document.querySelectorAll("."+mapDotClassName)].find((t=>{if(t[Object.getOwnPropertyNames(t).find((e=>e.startsWith("__reactInternalInstance")))].return.return.key===e)return console.log("FOUND"),t}))}}e.exports={HomeDetailsAnnotator:p}},128:e=>{e.exports={MapAnnotator:class{annotate(){}annotateMap(e,t){const s=t.median,r=t["25th"],a=t["75th"];this.getMapDotClassNames().forEach((t=>{const n=[...document.querySelectorAll("."+t)],i={};n.forEach((e=>{i[this.getZillowIdByElement(e)]=e})),e.forEach((e=>{const t=i[e.zpid.toString()];t&&(e.price>a?t.style.cssText=t.style.cssText+"background: #db3a00;":e.price>=s?t.style.cssText=t.style.cssText+"background: #ff9800;":e.price>=r?t.style.cssText=t.style.cssText+"background: #ffeb3b;":t.style.cssText=t.style.cssText+"background: #4caf50;")}))}))}getZillowIdByElement(e){return e[Object.getOwnPropertyNames(e).find((e=>e.startsWith("__reactInternalInstance")))].return.return.key}getMapDotClassNames(){return["property-dot","property-pill"]}}}},62:(e,t,s)=>{const{logMessage:r}=s(325),{DataAPI:a}=s(807),{BiggerPocketsRentAPI:n}=s(854);e.exports={BiggerPocketsRentAutomator:class{constructor(){this.dataApi=new a}async start(){try{const e=await this.dataApi.propertiesWithoutBiggerPocketsRent();r(`Found ${e.length} properties without BP rents`);for(let t=0;t<e.length;t++){const s=e[t];r("==========================="),r(`Property: ${s.address}`);const a=await n.fetch(s.address,s.bedrooms);if(a){r("Successfully fetched rent"),s.updateRent(a);const e=await this.dataApi.updateProperty(s);r(e?"Successfully updated property":"Failed to update property")}else r("Failed to fetch rent");await this.pause(3e3)}r("Finished!")}catch(e){throw r("Error"),e}}async pause(e){r(`Pause for ${e/1e3} seconds`),await new Promise((t=>setTimeout(t,e)))}}}},724:(e,t,s)=>{const{logMessage:r}=s(325),{DataAPI:a}=s(807),{HomeDetailsAPI:n}=s(259);e.exports={EmailAutomator:class{constructor(){this.dataApi=new a}async sync(){try{if(await this.syncEmails()){const e=await this.getMessages();await this.processMessages(e),r("Analyzed successfully")}}catch(e){throw r("Error"),e}}async syncEmails(){const e="OK"===await this.dataApi.syncEmails();return r(e?"Email successfully synced":"Emails failed to sync"),e}async getMessages(){const e=await this.dataApi.emails();return r(`Found ${e.length} new messages`),e}async processMessages(e){for(let t=0;t<e.length;t++){const s=e[t];await this.processMessage(s),await this.markMessageAsRead(s.id),await this.pause(3e3)}}async processMessage(e){r("=============================================="),r(`Parsing message (${e.id}) with ${e.addresses.length} addresses`);const t=await n.fetchAll(e.addresses),s=Object.keys(t);r(`Zillow API matched ${s.length} addresses`);for(let e=0;e<s.length;e++){const a=t[s[e]];a?(await this.dataApi.addProperty(a),r(`Saved property: ${a.address}`)):r(`Property not found on zillow: ${a.address}`)}}async markMessageAsRead(e){await this.dataApi.markEmailAsRead(e),r(`Message (${e}) marked as read`)}async pause(e){r(`Pause for ${e/1e3} seconds`),await new Promise((t=>setTimeout(t,e)))}}}},990:e=>{e.exports={RentometerAutomater:class{static search(e,t){document.querySelector("input#address_unified_search_address").value=e,document.querySelector("#address_unified_search_bed_style").value=t,setTimeout((()=>{document.querySelector('input[type="submit"]').click()}),3e3)}}}},559:e=>{e.exports={PROPERTY_ATTRIBTUES:["address","city","state","zipcode","homeType","homeStatus","price","bedrooms","bathrooms","yearBuilt","sqft","daysOnMarket","propertyTaxes","schools","schoolScores","priceHistory","rents","status","comps","nearbyHomes","updatedAt"],COLORS:{gray:"#EEEEEE",lightGray:"#F5F5F5",green:"#69f0ae",lightGreen:"#B9F6CA",red:"#FF5252",lightRed:"#FFCCBC",yellow:"#FFD740",lightYellow:"#FFE57F"},STATUS:{default:"DEFAULT",deal:"DEAL",notADeal:"NOT_A_DEAL",interested:"INTERESTED",notInterested:"NOT_INTERESTED",offer:"OFFER"}}},325:e=>{e.exports={rentToPrice:function(e,t){return e<=0||t<=0?-1:parseFloat((e/t).toFixed(4))},toDollar:function(e){return e<0?"N/A":e.toLocaleString("en-US",{style:"currency",currency:"USD"}).replace(/\.\d{2}$/,"")},toPercent:function(e){return e<0?"N/A":(100*e).toFixed(2)+"%"},average:function(e){if(0===e.length)return-1;const t=e.reduce(((e,t)=>e+t))/e.length;return 1e3*Math.round(t/1e3)},median:function(e){if(0==e.length)return-1;e.sort(((e,t)=>e-t));const t=Math.floor(e.length/2);return e.length%2==1?e[t]:(e[t-1]+e[t])/2},pct25th:function(e){return 0==e.length?-1:(e.sort(((e,t)=>e-t)),e[Math.ceil(.25*e.length)-1])},pct75th:function(e){return 0==e.length?-1:(e.sort(((e,t)=>e-t)),e[Math.ceil(.75*e.length)-1])},matchedText:function(e,t){const s=document.querySelector(e);return s?s.innerText.replace(/\n/g," ").match(t):null},matchedTexts:function(e,t){const s=document.querySelector(e);return s?s.innerText.replace(/\n/g," ").match(t):[]},findElement:function(e,t){const s=document.querySelectorAll(e);for(let e=0;e<s.length;e++){const r=s[e];if(r.innerHTML.match(t))return r}return null},findElementUntil:async function(e,t,s=0){const r=s>0?Math.ceil(s/300):1/0;let a=0;for(;a<r;){const r=document.querySelectorAll(e);for(let e=0;e<r.length;e++){const s=r[e];if(s.innerHTML.match(t))return s}if(0===s)return null;await new Promise((e=>setTimeout(e,300))),a++}return null},serializeAddress:function(e){return e.replace(/\u00A0/g," ").replace(/\s/g," ")},doAfter:async function(e,t){return await new Promise((e=>setTimeout(e,t))),e()},logMessage:function(e){const t=`[${(new Date).toLocaleTimeString()}] ${e}`;let s=document.getElementById("banner");s||(s=document.createElement("div"),s.id="banner",s.style.cssText="position: absolute; z-index: 1000000; background-color: white; padding: 10px;",document.body.insertBefore(s,document.body.firstChild));const r=document.createElement("div");r.innerText=t,s.insertBefore(r,s.firstChild)}}},74:(e,t,s)=>{const{PROPERTY_ATTRIBTUES:r}=s(559),{Property:a}=s(643),{matchedText:n,matchedTexts:i,serializeAddress:o}=s(325);class c{static parse(){const e=new c;return new a(e.summary)}get summary(){const e={};return r.forEach((t=>{e[t]=this[t]})),e}get property(){}get address(){return o(document.querySelector(".summary-container h1").innerText)}get zipcode(){const e=(this.address||"").match(/\d{5}$/);return e?e[0]:"N/A"}get price(){return this.parseValue(document.querySelector(".summary-container [data-testid='price']").innerText)}get bedrooms(){const e=i('[data-testid="bed-bath-beyond"]',/(\d) bd/);return e?parseInt(e[1]):-1}get bathrooms(){const e=i('[data-testid="bed-bath-beyond"]',/(\d) ba/);return e?parseInt(e[1]):-1}get yearBuilt(){const e=i(".ds-data-view-list",/built in (\d{4})/i);return e?parseInt(e[1]):-1}get sqft(){const e=i('[data-testid="bed-bath-beyond"]',/([\d|,]{2,7}) sqft/);return e?this.parseValue(e[1]):-1}get propertyTaxes(){const e=n(".ds-data-view-list",/property taxes \$([\d|,]+)/i);return e?this.parseValue(e[1]):-1}get daysOnMarket(){const e=n(".ds-data-view-list",/([\d|,]+) days? on zillow/i);return e?this.parseValue(e[1]):-1}get homeType(){const e=i(".data-view-container",/single family residence|townhouse|triplex|duplex/gi);return e?e[0]:"N/A"}get schoolScores(){return i("#ds-nearby-schools-list",/\d{1,2}\/10/g).map((e=>parseInt(e.replace(/\/10/,""))))}get priceHistory(){const e=[...document.querySelectorAll(".data-view-container li table tr")].map((e=>e.innerText.replace(/\t|\n/g," ")));return this.findPriceChanges(e,this.daysOnMarket)}parseValue(e){return parseInt(e.replace(/\$|,/g,""))}findPriceChanges(e,t){const s=(new Date).getTime()-24*t*60*60*1e3,r=/Price change\s+.*?\$(\d[\d,]*)\s+(-?\d*\.?\d*)%/,a=/(\d{1,2}\/\d{1,2}\/\d{4})/,n=[];for(let t=0;t<e.length;t++){const i=e[t];if(!i.includes("Price change"))continue;const o=i.match(a);if(!o)continue;const c=new Date(o[0]);if(c.getTime()<s)continue;const d=i.match(r);if(!d)continue;const l=parseInt(d[1].replace(/,/g,"")),h=parseFloat(d[2]),p=c.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"});n.push({date:p,price:l,percentChange:h})}return n}}e.exports={HomeDetailsParser:c}},849:(e,t,s)=>{const{Rent:r}=s(326),{average:a,median:n,pct25th:i,pct75th:o}=s(325);class c{constructor(e=document){return this.target=e,new r({address:this.address,zipcode:this.zipcode,bedrooms:this.bedrooms,average:this.average,median:this.median,pct25th:this.pct25th,pct75th:this.pct75th,count:this.count,source:null})}static parse(e=document){}get address(){}get zipcode(){}get bedrooms(){}get average(){}get median(){}get pct25th(){}get pct75th(){}get count(){}parseValue(e){return parseInt(e.replaceAll("$","").replaceAll(",",""))}}class d extends c{static parse(e=document){const t=new d(e);return t.setRentometer(),t}get address(){return this.useAddress()?document.querySelector("#address_unified_search_address").value.replace(/, USA$/,""):null}get zipcode(){if(this.useZipcode()){const e=document.querySelector("h3.result-address-header").innerText.replace(/quickview/i,"").trim().match(/\d{5}$/);return e&&e[0]}return null}get bedrooms(){return parseInt(this.target.querySelector("select#zip_unified_search_bed_style").value)}get average(){return this.parseValue(this.target.querySelector("[title='Sample Mean']").innerText)}get median(){return this.parseValue(this.target.querySelector("[title='Sample Median']").innerText)}get pct25th(){return this.parseValue(this.target.querySelector("[title^='This is the estimated value of the 25th']").innerText)}get pct75th(){return this.parseValue(this.target.querySelector("[title^='This is the estimated value of the 75th']").innerText)}get count(){const e=document.querySelector("#active-results-container").innerText.replaceAll("\n","").match(/Results based on (\d+), .* within (\d+) months/);return parseInt(e[1])}useAddress(){return!!document.querySelector(".search-type-tab.active a").innerText.trim().match(/address/i)}useZipcode(){return!!document.querySelector(".search-type-tab.active a").innerText.trim().match(/zip code/i)}}class l extends c{static parse(e=document){const t=new l(e);return t.setBiggerPockets(),t}get address(){return this.addressText&&5===this.addressText.length?null:this.addressText}get zipcode(){return this.addressText&&5===this.addressText.length?this.addressText:null}get bedrooms(){const e=this.target.querySelector('[name="validated_address_search[beds]"]');return e&&parseInt(e.value)}get average(){return parseInt(a(this.rents))}get median(){return parseInt(n(this.rents))}get pct25th(){return parseInt(i(this.rents))}get pct75th(){return parseInt(o(this.rents))}get count(){return this.rents.length}get rents(){const e=this.target.querySelector(".insights-result-comparable-properties-list-content");return e?e.innerText.match(/\$\d{1,3}(?:,\d{3})*(\.\d+)?/g).map((e=>this.parseValue(e))):null}get addressText(){const e=this.target.querySelector(".insights-result-title");return e&&e.innerText.replace(/\n/g," ").trim()}}class h extends c{static parse(e=document){const t=new h(e);return t.setZillow(),t}get address(){}get zipcode(){}get bedrooms(){}get average(){}get median(){}get pct25th(){}get pct75th(){}get count(){}}e.exports={RentParser:c,RentometerRentParser:d,BiggerPocketsRentParser:l,ZillowRentParser:h}},754:e=>{class t{static TABLE_ID="zillow-summary-table";static rerender(e){[...document.querySelectorAll("#"+t.TABLE_ID)].forEach((e=>e.remove())),t.render(e)}static render(e){const s=document.createElement("table");s.setAttribute("id",t.TABLE_ID);for(const t in e){const r=document.createElement("tr"),a=document.createElement("td"),n=document.createElement("td");a.innerText=t,n.innerText=e[t],r.appendChild(a),r.appendChild(n),s.appendChild(r)}return document.body.appendChild(s),t.addTableStyles(s),s}static addTableStyles(e){e.style.cssText="z-index: 100000; position: fixed; bottom: 30px; right: 40px; float: right; padding: 10px; background-color: #f2f2f2; border: 1px solid #ccc; opacity: 0.95;",t.addStyles(e,"td","border: 1px solid #ddd; padding: 8px; text-align: left;"),t.addStyles(e,"tr td:first-child","background-color: rgb(216 216 216 / 36%); border: 1px solid #ddd; padding: 8px; text-align: left;"),t.addStyles(e,"th","background-color: #4CAF50; color: white;")}static addStyles(e,t,s){[...e.querySelectorAll(t)].forEach((e=>{e.style.cssText=s}))}}e.exports={Renderer:t}},230:(e,t,s)=>{const{DataAPI:r}=s(807),{Property:a}=s(643),{HomeDetailsAPI:n}=s(259),{HomeDetailsParser:i}=s(74);async function o(){const e=new r,t=i.parse();return await e.findProperty(t.address)}e.exports={currentProperty:async function(){const e=i.parse().address,[t,s]=await Promise.all([n.fetch(e),o()]),r=t||new a;return s&&(r.rents=s.rents,r.status=s.status),r},savedProperty:o}},822:(e,t,s)=>{const r=s(857);e.exports={entry:{app:"./src/app.js"},output:{filename:"app.min.js",path:r.resolve("/","dist"),libraryTarget:"window"}}},454:(e,t,s)=>{var r={"./package":147,"./package-lock":959,"./package-lock.json":959,"./package.json":147,"./scripts/update_paths":588,"./scripts/update_paths.js":588,"./src/app":672,"./src/app.js":672,"./src/db/data_api":807,"./src/db/data_api.js":807,"./src/models/deal":537,"./src/models/deal.js":537,"./src/models/message":636,"./src/models/message.js":636,"./src/models/property":643,"./src/models/property.js":643,"./src/models/rent":326,"./src/models/rent.js":326,"./src/services/bigger_pockets_rent_api":854,"./src/services/bigger_pockets_rent_api.js":854,"./src/services/home_details_api":259,"./src/services/home_details_api.js":259,"./src/services/zillow":712,"./src/services/zillow.js":712,"./src/utils/analyzers/deal_analyzer":988,"./src/utils/analyzers/deal_analyzer.js":988,"./src/utils/analyzers/property_analyzer":487,"./src/utils/analyzers/property_analyzer.js":487,"./src/utils/annotators/home_details_annotator":52,"./src/utils/annotators/home_details_annotator.js":52,"./src/utils/annotators/map_annotator":128,"./src/utils/annotators/map_annotator.js":128,"./src/utils/automator/bigger_pockets_rent_automator":62,"./src/utils/automator/bigger_pockets_rent_automator.js":62,"./src/utils/automator/email_automator":724,"./src/utils/automator/email_automator.js":724,"./src/utils/automator/rentometer_automator":990,"./src/utils/automator/rentometer_automator.js":990,"./src/utils/constants":559,"./src/utils/constants.js":559,"./src/utils/helpers":325,"./src/utils/helpers.js":325,"./src/utils/parsers/home_details_parser":74,"./src/utils/parsers/home_details_parser.js":74,"./src/utils/parsers/rent_parser":849,"./src/utils/parsers/rent_parser.js":849,"./src/utils/renderer":754,"./src/utils/renderer.js":754,"./src/utils/session":230,"./src/utils/session.js":230,"./webpack.config":822,"./webpack.config.js":822};function a(e){var t=n(e);return s(t)}function n(e){if(!s.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=n,e.exports=a,a.id=454},65:()=>{},203:()=>{},857:()=>{},959:e=>{"use strict";e.exports=JSON.parse('{"name":"rei-automation","version":"1.0.0","lockfileVersion":2,"requires":true,"packages":{"":{"name":"rei-automation","version":"1.0.0","license":"ISC","devDependencies":{}}}}')},147:e=>{"use strict";e.exports=JSON.parse('{"name":"rei-automation","version":"1.0.0","description":"","main":"app.js","directories":{"lib":"lib"},"scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","build":"node scripts/update_paths.js && (rm dist/app.min.js || true) && webpack --mode production && cp dist/app.min.js ../../chrome-extensions/zillow","amend":"npm run build && git add . && git commit --amend --no-edit && git push -f","commit":"npm run build && git add . && git commit"},"repository":{"type":"git","url":"git+https://github.com/synergychen/rei-automation.git"},"author":"","license":"ISC","bugs":{"url":"https://github.com/synergychen/rei-automation/issues"},"homepage":"https://github.com/synergychen/rei-automation#readme","devDependencies":{},"browser":{"fs":false,"path":false,"os":false}}')}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=s(672),a=window;for(var n in r)a[n]=r[n];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();